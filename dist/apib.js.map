{"version":3,"file":"apib.js","sources":["../lib/apib.js"],"sourcesContent":["'use strict'\r\n\r\nimport { version } from '../package.json'\r\n\r\nclass API {\r\n  version = version\r\n\r\n  /**\r\n   * 将对象转为 URL QueryString\r\n   *\r\n   * @param {object} data\r\n   */\r\n  param(data) {\r\n    // https://jsperf.com/array-push-vs-string-concat\r\n    /*\r\n    let ret = []\r\n    Object.keys(data).forEach(v => {\r\n      ret.push(`${encodeURIComponent(v)}=${encodeURIComponent(data[v])}`)\r\n    })\r\n    return ret.join('&')\r\n    */\r\n    let ret = ''\r\n    Object.keys(data).forEach(v => {\r\n      ret = ret + `${encodeURIComponent(v)}=${encodeURIComponent(data[v])}&`\r\n    })\r\n    return ret.slice(0, -1)\r\n  }\r\n\r\n  /**\r\n   * 类型判断\r\n   *\r\n   * @param {any} unknown\r\n   * @param {boolen} keepCase 保持大小写\r\n   * @return {string}\r\n   */\r\n  type(unknown, keepCase) {\r\n    const type = Object.prototype.toString.call(unknown).slice(8, -1)\r\n    // https://jsperf.com/replace-vs-slice/5\r\n    // return type.replace('[object ', '').replace(']', '').toLowerCase()\r\n    return keepCase ? type : type.toLowerCase()\r\n  }\r\n\r\n  /**\r\n   * 将参数列表转为对象形式\r\n   *\r\n   * @param {array} list 参数原始对象，即 arguments\r\n   * @param {array} names 参数名称对应的数组，可以给默认值，默认值需要能被 JSON.parse 解析。\r\n   *\r\n   * 注意：\r\n   *  - 参数的值支持覆盖\r\n   *  - 在遇到对象之后直接退出\r\n   *\r\n   * 示例：\r\n   *   > args([1, 2, {xor: true}], ['offset', 'count'])\r\n   *   < {offset: 1, count: 2, xor: true}\r\n   */\r\n  args(list, names = []) {\r\n    const options = {}\r\n    names.forEach((item, index) => {\r\n      if (item.indexOf('=') > -1) {\r\n        const temp = item.split('=')\r\n        const name = temp[0]\r\n        names[index] = name\r\n        try {\r\n          options[name] = JSON.parse(temp.slice(1).join('='))\r\n        } catch (e) {\r\n          // ignore\r\n        }\r\n      }\r\n    })\r\n    for (let i = 0; i < list.length; i++) {\r\n      const item = list[i]\r\n      const name = names[i]\r\n      if (this.type(item) === 'object') {\r\n        Object.assign(options, item)\r\n        break\r\n      } else if (\r\n        this.type(item) !== 'undefined'\r\n        && this.type(name) !== 'undefined'\r\n      ) {\r\n        options[name] = item\r\n      }\r\n    }\r\n    return options\r\n  }\r\n\r\n  /**\r\n   * 拼接链接地址\r\n   *\r\n   * @param {array<string>} args\r\n   */\r\n  join(...args) {\r\n    let result = args[0] || ''\r\n    for (let i = 1; i < args.length; i++) {\r\n      if (args[i]) {\r\n        result = result.replace(/\\/+$/, '') + '/' + args[i].replace(/^\\/+/, '')\r\n      }\r\n    }\r\n    return result\r\n  }\r\n\r\n  // 需要自行实现 request 方法，基础方法不再进行提供\r\n  request() {\r\n    throw new Error('Not implemented yet')\r\n  }\r\n\r\n}\r\n\r\nexport default API\r\n"],"names":["API","version","param","data","ret","Object","keys","forEach","v","encodeURIComponent","slice","type","unknown","keepCase","prototype","toString","call","toLowerCase","args","list","names","options","item","index","indexOf","temp","split","name","JSON","parse","join","e","i","length","assign","result","replace","request","Error"],"mappings":";;;;;;;;MAIMA;;WACJC,UAAUA;;;;;EAEV;EACF;EACA;EACA;EACA;WACEC,QAAA,eAAMC,IAAN,EAAY;EACV;;EACA;EACJ;EACA;EACA;EACA;EACA;EACA;EACI,QAAIC,GAAG,GAAG,EAAV;EACAC,IAAAA,MAAM,CAACC,IAAP,CAAYH,IAAZ,EAAkBI,OAAlB,CAA0B,UAAAC,CAAC,EAAI;EAC7BJ,MAAAA,GAAG,GAAGA,GAAG,aAAMK,kBAAkB,CAACD,CAAD,CAAxB,cAA+BC,kBAAkB,CAACN,IAAI,CAACK,CAAD,CAAL,CAAjD,MAAT;EACD,KAFD;EAGA,WAAOJ,GAAG,CAACM,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAAP;EACD;EAED;EACF;EACA;EACA;EACA;EACA;EACA;;;WACEC,OAAA,cAAKC,OAAL,EAAcC,QAAd,EAAwB;EACtB,QAAMF,IAAI,GAAGN,MAAM,CAACS,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BJ,OAA/B,EAAwCF,KAAxC,CAA8C,CAA9C,EAAiD,CAAC,CAAlD,CAAb,CADsB;EAGtB;;EACA,WAAOG,QAAQ,GAAGF,IAAH,GAAUA,IAAI,CAACM,WAAL,EAAzB;EACD;EAED;EACF;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;;WACEC,OAAA,cAAKC,IAAL,EAAuB;EAAA,QAAZC,KAAY,uEAAJ,EAAI;EACrB,QAAMC,OAAO,GAAG,EAAhB;EACAD,IAAAA,KAAK,CAACb,OAAN,CAAc,UAACe,IAAD,EAAOC,KAAP,EAAiB;EAC7B,UAAID,IAAI,CAACE,OAAL,CAAa,GAAb,IAAoB,CAAC,CAAzB,EAA4B;EAC1B,YAAMC,IAAI,GAAGH,IAAI,CAACI,KAAL,CAAW,GAAX,CAAb;EACA,YAAMC,IAAI,GAAGF,IAAI,CAAC,CAAD,CAAjB;EACAL,QAAAA,KAAK,CAACG,KAAD,CAAL,GAAeI,IAAf;;EACA,YAAI;EACFN,UAAAA,OAAO,CAACM,IAAD,CAAP,GAAgBC,IAAI,CAACC,KAAL,CAAWJ,IAAI,CAACf,KAAL,CAAW,CAAX,EAAcoB,IAAd,CAAmB,GAAnB,CAAX,CAAhB;EACD,SAFD,CAEE,OAAOC,CAAP,EAAU;EAEX;EACF;EACF,KAXD;;EAYA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGb,IAAI,CAACc,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;EACpC,UAAMV,IAAI,GAAGH,IAAI,CAACa,CAAD,CAAjB;EACA,UAAML,IAAI,GAAGP,KAAK,CAACY,CAAD,CAAlB;;EACA,UAAI,KAAKrB,IAAL,CAAUW,IAAV,MAAoB,QAAxB,EAAkC;EAChCjB,QAAAA,MAAM,CAAC6B,MAAP,CAAcb,OAAd,EAAuBC,IAAvB;EACA;EACD,OAHD,MAGO,IACL,KAAKX,IAAL,CAAUW,IAAV,MAAoB,WAApB,IACG,KAAKX,IAAL,CAAUgB,IAAV,MAAoB,WAFlB,EAGL;EACAN,QAAAA,OAAO,CAACM,IAAD,CAAP,GAAgBL,IAAhB;EACD;EACF;;EACD,WAAOD,OAAP;EACD;EAED;EACF;EACA;EACA;EACA;;;WACES,OAAA,gBAAc;EAAA,sCAANZ,IAAM;EAANA,MAAAA,IAAM;EAAA;;EACZ,QAAIiB,MAAM,GAAGjB,IAAI,CAAC,CAAD,CAAJ,IAAW,EAAxB;;EACA,SAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGd,IAAI,CAACe,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;EACpC,UAAId,IAAI,CAACc,CAAD,CAAR,EAAa;EACXG,QAAAA,MAAM,GAAGA,MAAM,CAACC,OAAP,CAAe,MAAf,EAAuB,EAAvB,IAA6B,GAA7B,GAAmClB,IAAI,CAACc,CAAD,CAAJ,CAAQI,OAAR,CAAgB,MAAhB,EAAwB,EAAxB,CAA5C;EACD;EACF;;EACD,WAAOD,MAAP;EACD;;;WAGDE,UAAA,mBAAU;EACR,UAAM,IAAIC,KAAJ,CAAU,qBAAV,CAAN;EACD;;;;;;;;;;;"}